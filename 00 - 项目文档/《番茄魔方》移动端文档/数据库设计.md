---

---
--- 
```sql
CREATE TABLE `user_info` (
  `uid` INT AUTO_INCREMENT PRIMARY KEY COMMENT '主键，用户唯一标识',
  `open_id` VARCHAR(64) NOT NULL COMMENT '微信OpenID，加唯一索引',
  `nick_name` VARCHAR(32) NOT NULL DEFAULT '用户' COMMENT '用户昵称',
  `profile` VARCHAR(255) COMMENT '头像URL路径',
  `phone` VARCHAR(11) COMMENT '用户电话号码，用于识别微信/QQ中的同一账户',
  `vip_type` ENUM('month','quarter','year') COMMENT 'VIP类型：月-季-年（非VIP为NULL）',
  `vip_ddl` DATETIME COMMENT 'VIP到期时间',
  `register_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '注册时间',
  `is_online` BOOLEAN NOT NULL DEFAULT 0 COMMENT '0 - 离线 1 - 在线',
  `points` INT NOT NULL DEFAULT 0 COMMENT '积分',
  UNIQUE KEY `idx_open_id` (`open_id`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;


CREATE TABLE `focus_data` (
  `focus_id` INT AUTO_INCREMENT PRIMARY KEY COMMENT '主键',
  `uid` INT NOT NULL COMMENT '发起用户UID，外键关联user_info',
  `st_time` DATETIME(3) NOT NULL COMMENT '专注开始时间（毫秒精度）',
  `ed_time` DATETIME(3) COMMENT '专注结束时间（允许NULL，应对异常中断）',
  `duration` INT NOT NULL COMMENT '实际专注时长（秒）',
  `std_duration` INT NOT NULL COMMENT '设定专注时长（秒）',
  `is_effective` BOOLEAN NOT NULL DEFAULT 0 COMMENT '是否有效 (0/1)',
  `is_inGroup` BOOLEAN NOT NULL DEFAULT 0 COMMENT '组队专注时，记为1',
  CONSTRAINT `fk_focus_data_uid` FOREIGN KEY (`uid`) REFERENCES `user_info` (`uid`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;


CREATE TABLE `group_data` (
  `gid` INT AUTO_INCREMENT PRIMARY KEY COMMENT '组队id',
  `teammates` JSON NOT NULL COMMENT '队伍成员的uid数组',
  `is_success` BOOLEAN NOT NULL DEFAULT 0 COMMENT '是否成功',
  `total_duration` INT NOT NULL DEFAULT 0 COMMENT '实际专注时长（秒）'
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;


CREATE TABLE `task_data` (
  `tid` INT AUTO_INCREMENT PRIMARY KEY COMMENT '主键',
  `uid` INT NOT NULL COMMENT '创建用户UID，外键关联user_info',
  `type` TINYINT NOT NULL COMMENT '1打卡/2纪念日/3倒计时',
  `name` VARCHAR(50) NOT NULL COMMENT '任务名称',
  `target_time` DATETIME COMMENT '纪念日/倒计时的目标时间（打卡任务为NULL）',
  `check_cnt` INT COMMENT '打卡任务的总次数（非打卡任务为NULL）',
  `is_done` INT NOT NULL DEFAULT 0 COMMENT '0 - 进行中 1 - 已完成',
  `create_time` DATETIME NOT NULL COMMENT '创建时间',
  `theme` INT NOT NULL COMMENT '卡片主题(0-5对应下列六个主题色)',
  CONSTRAINT `fk_task_data_uid` FOREIGN KEY (`uid`) REFERENCES `user_info` (`uid`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;


CREATE TABLE `check_record` (
  `id` INT AUTO_INCREMENT PRIMARY KEY COMMENT '主键',
  `tid` INT NOT NULL COMMENT '外键关联task_data',
  `uid` INT NOT NULL COMMENT '外键关联user_info',
  `check_time` DATETIME(3) NOT NULL COMMENT '打卡时间（毫秒精度）',
  CONSTRAINT `fk_check_record_tid` FOREIGN KEY (`tid`) REFERENCES `task_data` (`tid`),
  CONSTRAINT `fk_check_record_uid` FOREIGN KEY (`uid`) REFERENCES `user_info` (`uid`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;


CREATE TABLE `vip_orders` (
  `order_id` INT AUTO_INCREMENT PRIMARY KEY COMMENT '业务订单号（唯一）',
  `uid` INT NOT NULL COMMENT '外键关联user_info',
  `vip_type` ENUM('month','quarter','year') NOT NULL COMMENT 'VIP类型',
  `purchase_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '购买时间',
  `expire_time` DATETIME NOT NULL COMMENT 'VIP过期时间',
  `activate_type` INT NOT NULL COMMENT '1 - 广告兑换 2 - 充值购买 3 - 激活码兑换 4 - 积分兑换',
  CONSTRAINT `fk_vip_orders_uid` FOREIGN KEY (`uid`) REFERENCES `user_info` (`uid`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;


CREATE TABLE `activation_code` (
  `code_id` INT AUTO_INCREMENT PRIMARY KEY COMMENT '激活码编号（唯一主键）',
  `content` VARCHAR(255) NOT NULL COMMENT '激活码的内容（管理端手动填写或随机生成）',
  `duration` DATETIME NOT NULL COMMENT 'VIP有效期',
  `uid` INT NOT NULL COMMENT '激活用户的uid',
  `order_id` INT NOT NULL COMMENT 'VIP订单的id',
  CONSTRAINT `fk_activation_code_uid` FOREIGN KEY (`uid`) REFERENCES `user_info` (`uid`),
  CONSTRAINT `fk_activation_code_order_id` FOREIGN KEY (`order_id`) REFERENCES `vip_orders` (`order_id`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_unicode_ci;
```